// 'filter':
// 	'AD|ğŸ‡¦ğŸ‡©|AE|ğŸ‡¦ğŸ‡ª|é˜¿æ‹‰ä¼¯|AF|ğŸ‡¦ğŸ‡«|AG|ğŸ‡¦ğŸ‡¬|AL|ğŸ‡¦ğŸ‡±|AM|ğŸ‡¦ğŸ‡²|AO|ğŸ‡¦ğŸ‡´|AR|ğŸ‡¦ğŸ‡·|é˜¿æ ¹å»·|AT|ğŸ‡¦ğŸ‡¹|AU|ğŸ‡¦ğŸ‡º|æ¾³å¤§åˆ©äºš|AZ|ğŸ‡¦ğŸ‡¿|BA|ğŸ‡§ğŸ‡¦|BB|ğŸ‡§ğŸ‡§|BD|ğŸ‡§ğŸ‡©|å­ŸåŠ æ‹‰|BE|ğŸ‡§ğŸ‡ª|BF|ğŸ‡§ğŸ‡«|BG|ğŸ‡§ğŸ‡¬|BH|ğŸ‡§ğŸ‡­|BI|ğŸ‡§ğŸ‡®|BJ|ğŸ‡§ğŸ‡¯|BN|ğŸ‡§ğŸ‡³|BO|ğŸ‡§ğŸ‡´|BR|ğŸ‡§ğŸ‡·|å·´è¥¿
// |BS|ğŸ‡§ğŸ‡¸|BT|ğŸ‡§ğŸ‡¹|BW|ğŸ‡§ğŸ‡¼|BZ|ğŸ‡§ğŸ‡¿|CA|ğŸ‡¨ğŸ‡¦|åŠ æ‹¿å¤§|CD|ğŸ‡¨ğŸ‡©|CF|ğŸ‡¨ğŸ‡«|CG|ğŸ‡¨ğŸ‡¬|CH|ğŸ‡¨ğŸ‡­|ç‘å£«|CI|ğŸ‡¨ğŸ‡®|CL|ğŸ‡¨ğŸ‡±|CM|ğŸ‡¨ğŸ‡²|CO|ğŸ‡¨ğŸ‡´|CR|ğŸ‡¨ğŸ‡·|CV|ğŸ‡¨ğŸ‡»|CY|ğŸ‡¨ğŸ‡¾|CZ|ğŸ‡¨ğŸ‡¿|DE|ğŸ‡©ğŸ‡ª|å¾·å›½|DJ|ğŸ‡©ğŸ‡¯|DK|ğŸ‡©ğŸ‡°|DM|ğŸ‡©ğŸ‡²|DO|ğŸ‡©ğŸ‡´|DZ|ğŸ‡©ğŸ‡¿|EC|ğŸ‡ªğŸ‡¨|EE|ğŸ‡ªğŸ‡ª|çˆ±æ²™å°¼äºš
// |EG|ğŸ‡ªğŸ‡¬|åŸƒåŠ|ER|ğŸ‡ªğŸ‡·|ES|ğŸ‡ªğŸ‡¸|ET|ğŸ‡ªğŸ‡¹|FI|ğŸ‡«ğŸ‡®|èŠ¬å…°|FJ|ğŸ‡«ğŸ‡¯|FM|ğŸ‡«ğŸ‡²|FR|ğŸ‡«ğŸ‡·|æ³•å›½|GA|ğŸ‡¬ğŸ‡¦|åŠ è“¬|GB|ğŸ‡¬ğŸ‡§|è‹±å›½|GD|ğŸ‡¬ğŸ‡©|GE|ğŸ‡¬ğŸ‡ª|GH|ğŸ‡¬ğŸ‡­|GM|ğŸ‡¬ğŸ‡²|GN|ğŸ‡¬ğŸ‡³|GQ|ğŸ‡¬ğŸ‡¶|GR|ğŸ‡¬ğŸ‡·|GT|ğŸ‡¬ğŸ‡¹|GW|ğŸ‡¬ğŸ‡¼|GY|æ¸¯|HK|Hong Kong|HongKong|ğŸ‡­ğŸ‡°|ğŸ‡¬ğŸ‡¾|HN|ğŸ‡­ğŸ‡³|HR|ğŸ‡­ğŸ‡·|HT|ğŸ‡­ğŸ‡¹|HU|ğŸ‡­ğŸ‡º|ID|ğŸ‡®ğŸ‡©|å°å°¼
// |IE|ğŸ‡®ğŸ‡ª|IL|ğŸ‡®ğŸ‡±|IN|ğŸ‡®ğŸ‡³|å°åº¦|IQ|ğŸ‡®ğŸ‡¶|ä¼Šæ‹‰å…‹|IS|ğŸ‡®ğŸ‡¸|IT|ğŸ‡®ğŸ‡¹|æ„å¤§åˆ©|JM|ğŸ‡¯ğŸ‡²|JO|ğŸ‡¯ğŸ‡´|JP|ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|Japan|KE|ğŸ‡°ğŸ‡ª|KG|ğŸ‡°ğŸ‡¬|KH|ğŸ‡°ğŸ‡­|æŸ¬åŸ”å¯¨|KI|ğŸ‡°ğŸ‡®|KM|ğŸ‡°ğŸ‡²|KN|ğŸ‡°ğŸ‡³|éŸ©å›½|KR|Korea|KOR|ğŸ‡°ğŸ‡·|KW|ğŸ‡°ğŸ‡¼|KZ|ğŸ‡°ğŸ‡¿|å“ˆè¨å…‹|LA|ğŸ‡±ğŸ‡¦|è€æŒ
// |LB|ğŸ‡±ğŸ‡§|LC|ğŸ‡±ğŸ‡¨|LI|ğŸ‡±ğŸ‡®|LK|ğŸ‡±ğŸ‡°|LR|ğŸ‡±ğŸ‡·|LS|ğŸ‡±ğŸ‡¸|LT|ğŸ‡±ğŸ‡¹|LU|ğŸ‡±ğŸ‡º|LV|ğŸ‡±ğŸ‡»|LY|ğŸ‡±ğŸ‡¾|MA|ğŸ‡²ğŸ‡¦|MC|ğŸ‡²ğŸ‡¨|MD|ğŸ‡²ğŸ‡©|ME|ğŸ‡²ğŸ‡ª|MG|ğŸ‡²ğŸ‡¬|MH|ğŸ‡²ğŸ‡­|MK|ğŸ‡²ğŸ‡°|ML|ğŸ‡²ğŸ‡±|MM|ğŸ‡²ğŸ‡²|ç¼…ç”¸|MN|ğŸ‡²ğŸ‡³|MO|ğŸ‡²ğŸ‡´|æ¾³é—¨|MR|ğŸ‡²ğŸ‡·|MT|ğŸ‡²ğŸ‡¹|MU|ğŸ‡²ğŸ‡º|MV|ğŸ‡²ğŸ‡»|MW|ğŸ‡²ğŸ‡¼|MX|ğŸ‡²ğŸ‡½
// |MY|ğŸ‡²ğŸ‡¾|é©¬æ¥è¥¿äºš|MZ|ğŸ‡²ğŸ‡¿|NA|ğŸ‡³ğŸ‡¦|NE|ğŸ‡³ğŸ‡ª|NG|ğŸ‡³ğŸ‡¬|å°¼æ—¥åˆ©äºš|NI|ğŸ‡³ğŸ‡®|NL|ğŸ‡³ğŸ‡±|è·å…°|NO|ğŸ‡³ğŸ‡´|NP|ğŸ‡³ğŸ‡µ|NR|ğŸ‡³ğŸ‡·|NZ|ğŸ‡³ğŸ‡¿|OM|ğŸ‡´ğŸ‡²|PA|ğŸ‡µğŸ‡¦|PE|ğŸ‡µğŸ‡ª|PG|ğŸ‡µğŸ‡¬|PH|ğŸ‡µğŸ‡­|PK|ğŸ‡µğŸ‡°|å·´åŸºæ–¯å¦|PL|ğŸ‡µğŸ‡±|PS|ğŸ‡µğŸ‡¸|PT|ğŸ‡µğŸ‡¹|PW|ğŸ‡µğŸ‡¼|PY|ğŸ‡µğŸ‡¾|QA|ğŸ‡¶ğŸ‡¦|RO|ğŸ‡·ğŸ‡´|RS|ğŸ‡·ğŸ‡¸
// |RUS|ğŸ‡·ğŸ‡º|ä¿„ç½—æ–¯|RW|ğŸ‡·ğŸ‡¼|SA|ğŸ‡¸ğŸ‡¦|SB|ğŸ‡¸ğŸ‡§|SC|ğŸ‡¸ğŸ‡¨|SD|ğŸ‡¸ğŸ‡©|SE|ğŸ‡¸ğŸ‡ª|SG|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|Singapore|SI|ğŸ‡¸ğŸ‡®|SK|ğŸ‡¸ğŸ‡°|SL|ğŸ‡¸ğŸ‡±|SM|ğŸ‡¸ğŸ‡²|SN|ğŸ‡¸ğŸ‡³|SO|ğŸ‡¸ğŸ‡´|SR|ğŸ‡¸ğŸ‡·|SS|ğŸ‡¸ğŸ‡¸|ST|ğŸ‡¸ğŸ‡¹|SV|ğŸ‡¸ğŸ‡»|SZ|ğŸ‡¸ğŸ‡¿|TD|ğŸ‡¹ğŸ‡©|TG|ğŸ‡¹ğŸ‡¬|TH|ğŸ‡¹ğŸ‡­|æ³°å›½|TJ|ğŸ‡¹ğŸ‡¯|TL|ğŸ‡¹ğŸ‡±|TM|ğŸ‡¹ğŸ‡²|TN|ğŸ‡¹ğŸ‡³|TO|ğŸ‡¹ğŸ‡´
// |TR|ğŸ‡¹ğŸ‡·|åœŸè€³å…¶|TT|ğŸ‡¹ğŸ‡¹|TV|ğŸ‡¹ğŸ‡»|å°|å°æ¹¾|TAIWAN|TW|TAI WAN|ğŸ‡¹ğŸ‡¼|TZ|ğŸ‡¹ğŸ‡¿|UA|ğŸ‡ºğŸ‡¦|ä¹Œå…‹å…°|UG|ğŸ‡ºğŸ‡¬|United States|America|USA|US|ğŸ‡ºğŸ‡¸|ç¾å›½|UY|ğŸ‡ºğŸ‡¾|UZ|ğŸ‡ºğŸ‡¿|VA|ğŸ‡»ğŸ‡¦|VC|ğŸ‡»ğŸ‡¨|VN|ğŸ‡»ğŸ‡³|è¶Šå—|VU|ğŸ‡»ğŸ‡º|WS|ğŸ‡¼ğŸ‡¸|YE|ğŸ‡¾ğŸ‡ª|ZA|ğŸ‡¿ğŸ‡¦|ZM|ğŸ‡¿ğŸ‡²|ZW|ğŸ‡¿ğŸ‡¼',

// https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml
// https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml
// https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml

// å›½å†…DNSæœåŠ¡å™¨
const domesticNameservers = [
	'https://dns.alidns.com/dns-query', // é˜¿é‡Œäº‘å…¬å…±DNS
	'https://doh.pub/dns-query', // è…¾è®¯DNSPod
	'https://doh.360.cn/dns-query', // 360å®‰å…¨DNS
]
// å›½å¤–DNSæœåŠ¡å™¨
const foreignNameservers = [
	'https://1.1.1.1/dns-query', // Cloudflare(ä¸»)
	'https://1.0.0.1/dns-query', // Cloudflare(å¤‡)
	'https://208.67.222.222/dns-query', // OpenDNS(ä¸»)
	'https://208.67.220.220/dns-query', // OpenDNS(å¤‡)
	'https://194.242.2.2/dns-query', // Mullvad(ä¸»)
	'https://194.242.2.3/dns-query', // Mullvad(å¤‡)
]
// DNSé…ç½®
const dnsConfig = {
	'enable': true,
	'listen': '0.0.0.0:1053',
	'ipv6': true,
	'use-system-hosts': false,
	'cache-algorithm': 'arc',
	'enhanced-mode': 'fake-ip',
	'fake-ip-range': '198.18.0.1/16',
	'fake-ip-filter': [
		// æœ¬åœ°ä¸»æœº/è®¾å¤‡
		'+.lan',
		'+.local',
		// Windowsç½‘ç»œå‡ºç°å°åœ°çƒå›¾æ ‡
		'+.msftconnecttest.com',
		'+.msftncsi.com',
		// QQå¿«é€Ÿç™»å½•æ£€æµ‹å¤±è´¥
		'localhost.ptlogin2.qq.com',
		'localhost.sec.qq.com',
		// å¾®ä¿¡å¿«é€Ÿç™»å½•æ£€æµ‹å¤±è´¥
		'localhost.work.weixin.qq.com',
	],
	'default-nameserver': ['223.5.5.5', '119.29.29.29', '1.1.1.1', '8.8.8.8'],
	'nameserver': [...domesticNameservers, ...foreignNameservers],
	'proxy-server-nameserver': [...domesticNameservers, ...foreignNameservers],
	'nameserver-policy': {
		'geosite:private,cn,geolocation-cn': domesticNameservers,
		'geosite:google,youtube,telegram,gfw,geolocation-!cn': foreignNameservers,
	},
}
// è§„åˆ™é›†é€šç”¨é…ç½®
const ruleProviderCommon = {
	type: 'http',
	format: 'yaml',
	interval: 86400,
}
// è§„åˆ™é›†é…ç½®
const ruleProviders = {
	// å»å¹¿å‘Š ---------------------------------------------------------
	'AdvertisingLite_Domain': {
		...ruleProviderCommon,
		behavior: 'domain',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/AdvertisingLite/AdvertisingLite_Domain.yaml',
		path: './ruleset/AdvertisingLite_Domain.yaml',
	},
	// å·´å“ˆå§†ç‰¹ ------------------------------------------------------------
	'Bahamut': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Bahamut/Bahamut.yaml',
		path: './ruleset/Bahamut.yaml',
	},
	// Netflix ------------------------------------------------------------
	'Netflix': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix.yaml',
		path: './ruleset/Netflix.yaml',
	},
	'Netflix_IP': {
		...ruleProviderCommon,
		behavior: 'ipcidr',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix_IP.yaml',
		path: './ruleset/Netflix_IP.yaml',
	},
	// AI ------------------------------------------------------------
	'Gemini': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Gemini/Gemini.yaml',
		path: './ruleset/Gemini.yaml',
	},
	'Copilot': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Copilot/Copilot.yaml',
		path: './ruleset/Copilot.yaml',
	},
	'Claude': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Claude/Claude.yaml',
		path: './ruleset/Claude.yaml',
	},
	'BardAI': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/BardAI/BardAI.yaml',
		path: './ruleset/BardAI.yaml',
	},
	'OpenAI': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml',
		path: './ruleset/OpenAI.yaml',
	},
	// å¤§é™†åŸŸåã€IP --------------------------------------------------------
	'ChinaMax_Domain': {
		...ruleProviderCommon,
		behavior: 'domain',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ChinaMax/ChinaMax_Domain.yaml',
		path: './ruleset/ChinaMax_Domain.yaml',
	},
	'ChinaMax_IP': {
		...ruleProviderCommon,
		behavior: 'ipcidr',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ChinaMax/ChinaMax_IP.yaml',
		path: './ruleset/ChinaMax_IP.yaml',
	},
	// è°·æ­Œip ******************************************************
	'GoogleIP': {
		...ruleProviderCommon,
		behavior: 'ipcidr',
		url: 'https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.yaml',
		path: './ruleset/GoogleIP.yaml',
	},
	// è°·æ­ŒåŸŸå --------------------------------------------------------
	'Google': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Google/Google.yaml',
		path: './ruleset/Google.yaml',
	},
	// YouTubeåŸŸå --------------------------------------------------------
	'YouTube': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml',
		path: './ruleset/YouTube.yaml',
	},
	'YouTubeMusic': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTubeMusic/YouTubeMusic.yaml',
		path: './ruleset/YouTubeMusic.yaml',
	},
	// éå¤§é™†åŸŸå ******************************************************
	'geolocation-!cn': {
		...ruleProviderCommon,
		behavior: 'domain',
		url: 'https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.yaml',
		path: './ruleset/geolocation-!cn.yaml',
	},
	// ç”µæŠ¥åŸŸå -------------------------------------------------------
	'Telegram': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml',
		path: './ruleset/Telegram.yaml',
	},
	// ç”µæŠ¥IP ******************************************************
	// 'telegram_ip': {
	// 	...ruleProviderCommon,
	// 	behavior: 'ipcidr',
	// 	url: 'https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.yaml',
	// 	path: './ruleset/telegram_ip.yaml',
	// },
	// Steam ---------------------------------------------------------
	'Steam': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Steam/Steam.yaml',
		path: './ruleset/Steam.yaml',
	},
	// SteamCN ---------------------------------------------------------
	'SteamCN_No_Resolve': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/SteamCN/SteamCN_No_Resolve.yaml',
		path: './ruleset/SteamCN_No_Resolve.yaml',
	},
	// Apple ---------------------------------------------------------
	'Apple_No_Resolve': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple_No_Resolve.yaml',
		path: './ruleset/Apple_No_Resolve.yaml',
	},
	'Apple_Domain': {
		...ruleProviderCommon,
		behavior: 'domain',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple_Domain.yaml',
		path: './ruleset/Apple_Domain.yaml',
	},
	// Microsoft ---------------------------------------------------------
	'Microsoft_No_Resolve': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Microsoft/Microsoft_No_Resolve.yaml',
		path: './ruleset/Microsoft_No_Resolve.yaml',
	},
	// å±€åŸŸç½‘ ---------------------------------------------------------
	'Lan_No_Resolve': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Lan/Lan_No_Resolve.yaml',
		path: './ruleset/Lan_No_Resolve.yaml',
	},
	//  applications ******************************************************
	'applications': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/vanchkong/proxy-rules@release/applications-rules.txt',
		path: './ruleset/applications.yaml',
	},
	// Github ---------------------------------------------------------
	'Github': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GitHub/GitHub.yaml',
		path: './ruleset/GitHub.yaml',
	},
	// Discord ---------------------------------------------------------
	// 'Discord': {
	// 	...ruleProviderCommon,
	// 	behavior: 'classical',
	// 	url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Discord/Discord.yaml',
	// 	path: './ruleset/Discord.yaml',
	// },
	// è‡ªå®šä¹‰ ******************************************************
	'custom-proxy': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/vanchkong/proxy-rules@release/custom-proxy-rules.txt',
		path: './ruleset/custom-proxy.yaml',
	},
	'custom-direct': {
		...ruleProviderCommon,
		behavior: 'classical',
		url: 'https://cdn.jsdelivr.net/gh/vanchkong/proxy-rules@release/custom-direct-rules.txt',
		path: './ruleset/custom-direct.yaml',
	},
}

// è§„åˆ™
const rules = [
	'RULE-SET,applications,å…¨å±€ç›´è¿ ğŸ ',
	'RULE-SET,Lan_No_Resolve,å…¨å±€ç›´è¿ ğŸ ',
	'RULE-SET,custom-direct,å…¨å±€ç›´è¿ ğŸ ',
	'RULE-SET,custom-proxy,åœ°åŒºé€‰æ‹© ğŸŒ',
	'RULE-SET,AdvertisingLite_Domain,å…¨å±€æ‹¦æˆª ğŸš§',
	'RULE-SET,Microsoft_No_Resolve,å¾®è½¯æœåŠ¡ â“‚ï¸',
	'RULE-SET,Apple_No_Resolve,è‹¹æœæœåŠ¡ ğŸ',
	'RULE-SET,Apple_Domain,è‹¹æœæœåŠ¡ ğŸ',
	'RULE-SET,SteamCN_No_Resolve,å…¨å±€ç›´è¿ ğŸ ',
	'RULE-SET,Steam,è’¸æ±½å¹³å° ğŸ®',
	'RULE-SET,Bahamut,å·´å“ˆå§†ç‰¹ ğŸ“º',
	'RULE-SET,Netflix,å¥ˆé£æœåŠ¡ ğŸ“º',
	'RULE-SET,Netflix_IP,å¥ˆé£æœåŠ¡ ğŸ“º',
	'RULE-SET,Gemini,äººå·¥æ™ºèƒ½ ğŸ¤–',
	'RULE-SET,Copilot,äººå·¥æ™ºèƒ½ ğŸ¤–',
	'RULE-SET,Claude,äººå·¥æ™ºèƒ½ ğŸ¤–',
	'RULE-SET,BardAI,äººå·¥æ™ºèƒ½ ğŸ¤–',
	'RULE-SET,OpenAI,äººå·¥æ™ºèƒ½ ğŸ¤–',
	'RULE-SET,Telegram,ç”µæŠ¥æœåŠ¡ ğŸ’¬',
	// 'RULE-SET,telegram_ip,ç”µæŠ¥æœåŠ¡ ğŸ’¬',
	'RULE-SET,Google,è°·æ­ŒæœåŠ¡ ğŸ‡ºğŸ‡¸',
	'RULE-SET,GoogleIP,è°·æ­ŒæœåŠ¡ ğŸ‡ºğŸ‡¸',
	'RULE-SET,YouTube,è°·æ­ŒæœåŠ¡ ğŸ‡ºğŸ‡¸',
	'RULE-SET,YouTubeMusic,è°·æ­ŒæœåŠ¡ ğŸ‡ºğŸ‡¸',
	'RULE-SET,Github,åœ°åŒºé€‰æ‹© ğŸŒ',
	'RULE-SET,geolocation-!cn,åœ°åŒºé€‰æ‹© ğŸŒ',
	'RULE-SET,ChinaMax_Domain,å…¨å±€ç›´è¿ ğŸ ',
	'RULE-SET,ChinaMax_IP,å…¨å±€ç›´è¿ ğŸ ,no-resolve',
	'MATCH,æ¼ç½‘ä¹‹é±¼ ğŸŸ',
]
// ä»£ç†ç»„é€šç”¨é…ç½®
const groupBaseOption = {
	'interval': 300,
	'tolerance': 200,
	'timeout': 3000,
	'url': 'https://www.google.com/generate_204',
	'lazy': true,
	'max-failed-times': 2,
	'hidden': false,
}

// ç¨‹åºå…¥å£
function main(config) {
	const proxyCount = config?.proxies?.length ?? 0
	const proxyProviderCount = typeof config?.['proxy-providers'] === 'object' ? Object.keys(config['proxy-providers']).length : 0
	if (proxyCount === 0 && proxyProviderCount === 0) {
		throw new Error('é…ç½®æ–‡ä»¶ä¸­æœªæ‰¾åˆ°ä»»ä½•ä»£ç†')
	}

	if (config?.['proxy-providers'] === 'object') {
		console.log(config?.['proxy-providers'])
	}

	const sortArrByOrder = (arr, order, key) => {
		let filterArr = []
		let leftArr = []
		// leftArr ä½œç”¨æ˜¯å½“orderä¸­ä¸å­˜åœ¨ç›¸åº”valueæ—¶ï¼Œæœ€åè¿”å›æ—¶æ’åºåœ¨æœ€å å¦‚æœéœ€è¦æ’åºåœ¨æœ€å‰é¢ï¼Œåˆ™å–æ¶ˆleftArrè¿™ä¸€æ­¥ï¼Œåªè°ƒç”¨sortæ–¹æ³•å³å¯
		if (key) {
			filterArr = arr.filter((item) => {
				return order.some((item2) => {
					return item[key].toUpperCase().indexOf(item2) !== -1
				})
			})
			leftArr = arr.filter((item) => {
				return order.every((item2) => {
					return item[key].toUpperCase().indexOf(item2) === -1
				})
			})
		} else {
			filterArr = arr.filter((item) => order.indexOf(item) !== -1)
			leftArr = arr.filter((item) => order.indexOf(item) === -1)
		}
		filterArr.sort((a, b) => {
			if (key) {
				// return order.indexOf(a[key].toUpperCase()) - order.indexOf(b[key].toUpperCase())
				let index1 = 0
				let index2 = 0
				order.some((item2, index) => {
					index1 = index
					return a[key].toUpperCase().indexOf(item2) !== -1
				})
				order.some((item2, index) => {
					index2 = index
					return b[key].toUpperCase().indexOf(item2) !== -1
				})
				return index1 - index2
			} else {
				return order.indexOf(a) - order.indexOf(b)
			}
		})
		return filterArr.concat(leftArr)
	}

	const sortedAllProxy = sortArrByOrder(
		config?.proxies,
		[
			'å‰©',
			'åˆ°',
			'é‡',
			'é˜²',
			'ç”µæŠ¥',
			'ç¾¤ç»„',
			'é¢‘é“',
			'å…¬ç›Š',
			'ä»˜è´¹',
			'ğŸ‡­ğŸ‡°',
			'HK',
			'HONG KONG',
			'HongKong',
			'æ¸¯',
			'United States',
			'America',
			'USA',
			'US',
			'ğŸ‡ºğŸ‡¸',
			'ç¾å›½',
			'TW',
			'TAIWAN',
			'TAI WAN',
			'å°',
			'å°æ¹¾',
			'ğŸ‡¹ğŸ‡¼',
			'JP',
			'JAPAN',
			'ğŸ‡¯ğŸ‡µ',
			'æ—¥æœ¬',
			'SG',
			'Singapore',
			'ğŸ‡¸ğŸ‡¬',
			'æ–°åŠ å¡',
			'éŸ©å›½',
			'KR',
			'Korea',
			'KOR',
			'ğŸ‡°ğŸ‡·',
		],
		'name',
	)

	// console.log(sortedAllProxy)

	const allProxy = []
	const unpopularProxy = []
	const rep =
		/å‰©|åˆ°|é‡|é˜²|ç”µæŠ¥|ç¾¤ç»„|é¢‘é“|å…¬ç›Š|ä»˜è´¹|United States|America|USA|US|ğŸ‡ºğŸ‡¸|ç¾å›½|SG|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|Singapore|JP|ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|Japan|æ¸¯|HK|Hong Kong|HongKong|ğŸ‡­ğŸ‡°|å°|å°æ¹¾|TAIWAN|TW|TAI WAN|ğŸ‡¹ğŸ‡¼|éŸ©å›½|KR|Korea|KOR|ğŸ‡°ğŸ‡·/i
	sortedAllProxy.forEach((item) => {
		allProxy.push(item['name'])
		if (!rep.test(item['name'])) {
			unpopularProxy.push(item['name'])
		}
	})

	// è¦†ç›–åŸé…ç½®ä¸­DNSé…ç½®
	config['dns'] = dnsConfig

	// è¦†ç›–åŸé…ç½®ä¸­çš„ä»£ç†ç»„
	config['proxy-groups'] = [
		// åœ°åŒºé€‰æ‹©
		{
			...groupBaseOption,
			name: 'åœ°åŒºé€‰æ‹© ğŸŒ',
			type: 'select',
			proxies: ['è‡ªåŠ¨é€‰æ‹© ğŸ“¡', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'é¦™æ¸¯èŠ‚ç‚¹ ğŸ‡­ğŸ‡°', 'æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ', 'ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸', 'å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³', 'æ–°åŠ å¡èŠ‚ç‚¹ ğŸ‡¸ğŸ‡¬', 'éŸ©å›½èŠ‚ç‚¹ ğŸ‡°ğŸ‡·', 'å†·é—¨åœ°åŒº â„ï¸', 'å…¨å±€ç›´è¿ ğŸ '],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Area.png',
		},
		// å†·é—¨åœ°åŒº
		{
			...groupBaseOption,
			name: 'å†·é—¨åœ°åŒº â„ï¸',
			type: 'select',
			proxies: [...unpopularProxy, 'å…¨å±€ç›´è¿ ğŸ '],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/World_Map.png',
		},
		// æ‰€æœ‰èŠ‚ç‚¹
		{
			...groupBaseOption,
			name: 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ',
			type: 'select',
			proxies: [...allProxy],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Available.png',
		},
		// AIGC
		{
			...groupBaseOption,
			name: 'äººå·¥æ™ºèƒ½ ğŸ¤–',
			type: 'select',
			proxies: ['æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ', 'ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸', 'åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ'],
			filter: 'US|ğŸ‡ºğŸ‡¸|ç¾å›½|United States|TW|ğŸ‡¹ğŸ‡¼|å°æ¹¾',
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Bot.png',
		},
		// å·´å“ˆå§†ç‰¹
		{
			...groupBaseOption,
			name: 'å·´å“ˆå§†ç‰¹ ğŸ“º',
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Bahamut.png',
			type: 'select',
			proxies: ['å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³', 'åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'å…¨å±€ç›´è¿ ğŸ '],
		},
		// è°·æ­ŒæœåŠ¡
		{
			...groupBaseOption,
			name: 'è°·æ­ŒæœåŠ¡ ğŸ‡ºğŸ‡¸',
			type: 'select',
			proxies: ['åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'é¦™æ¸¯èŠ‚ç‚¹ ğŸ‡­ğŸ‡°', 'æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ', 'ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸', 'å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³', 'æ–°åŠ å¡èŠ‚ç‚¹ ğŸ‡¸ğŸ‡¬', 'éŸ©å›½èŠ‚ç‚¹ ğŸ‡°ğŸ‡·', 'å†·é—¨åœ°åŒº â„ï¸'],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Google_Search.png',
		},
		// è’¸æ±½å¹³å° ğŸ®
		{
			...groupBaseOption,
			name: 'è’¸æ±½å¹³å° ğŸ®',
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Steam.png',
			type: 'select',
			proxies: ['åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'é¦™æ¸¯èŠ‚ç‚¹ ğŸ‡­ğŸ‡°', 'æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ', 'ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸', 'å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³', 'æ–°åŠ å¡èŠ‚ç‚¹ ğŸ‡¸ğŸ‡¬', 'éŸ©å›½èŠ‚ç‚¹ ğŸ‡°ğŸ‡·', 'å†·é—¨åœ°åŒº â„ï¸'],
		},
		// è’¸æ±½å¹³å°CN ğŸ®
		// {
		// 	...groupBaseOption,
		// 	name: 'è’¸æ±½å¹³å°CN ğŸ®',
		// 	icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Steam.png',
		// 	type: 'select',
		// 	proxies: ['å…¨å±€ç›´è¿ ğŸ '],
		// 	hidden: true,
		// },
		// å¥ˆé£æœåŠ¡ ğŸ“º
		{
			...groupBaseOption,
			name: 'å¥ˆé£æœåŠ¡ ğŸ“º',
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Netflix.png',
			type: 'select',
			proxies: ['åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'é¦™æ¸¯èŠ‚ç‚¹ ğŸ‡­ğŸ‡°', 'æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ', 'ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸', 'å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³', 'æ–°åŠ å¡èŠ‚ç‚¹ ğŸ‡¸ğŸ‡¬', 'éŸ©å›½èŠ‚ç‚¹ ğŸ‡°ğŸ‡·', 'å†·é—¨åœ°åŒº â„ï¸'],
		},
		// ç”µæŠ¥æœåŠ¡ ğŸ’¬
		{
			...groupBaseOption,
			name: 'ç”µæŠ¥æœåŠ¡ ğŸ’¬',
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Telegram.png',
			type: 'select',
			proxies: ['åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'é¦™æ¸¯èŠ‚ç‚¹ ğŸ‡­ğŸ‡°', 'æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ', 'ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸', 'å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³', 'æ–°åŠ å¡èŠ‚ç‚¹ ğŸ‡¸ğŸ‡¬', 'éŸ©å›½èŠ‚ç‚¹ ğŸ‡°ğŸ‡·', 'å†·é—¨åœ°åŒº â„ï¸'],
		},
		// å¾®è½¯æœåŠ¡ â“‚ï¸
		{
			...groupBaseOption,
			name: 'å¾®è½¯æœåŠ¡ â“‚ï¸',
			type: 'select',
			proxies: ['å…¨å±€ç›´è¿ ğŸ ', 'åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ'],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Microsoft.png',
		},
		// è‹¹æœæœåŠ¡ ğŸ
		{
			...groupBaseOption,
			name: 'è‹¹æœæœåŠ¡ ğŸ',
			type: 'select',
			proxies: ['å…¨å±€ç›´è¿ ğŸ ', 'åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ'],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Apple.png',
		},
		// å…¨å±€ç›´è¿ ğŸ 
		{
			...groupBaseOption,
			name: 'å…¨å±€ç›´è¿ ğŸ ',
			type: 'select',
			proxies: ['DIRECT', 'REJECT'],
			url: 'http://wifi.vivo.com.cn/generate_204',
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Direct.png',
			hidden: true,
		},
		// å…¨å±€æ‹¦æˆª ğŸš§
		{
			...groupBaseOption,
			name: 'å…¨å±€æ‹¦æˆª ğŸš§',
			type: 'select',
			proxies: ['REJECT', 'DIRECT'],
			url: 'http://wifi.vivo.com.cn/generate_204',
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/AdBlack.png',
			hidden: true,
		},
		// æ¼ç½‘ä¹‹é±¼ ğŸŸ
		{
			...groupBaseOption,
			name: 'æ¼ç½‘ä¹‹é±¼ ğŸŸ',
			type: 'select',
			proxies: ['åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'å…¨å±€ç›´è¿ ğŸ '],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Final.png',
		},
		// GLOBAL
		{
			name: 'GLOBAL',
			type: 'select',
			proxies: ['åœ°åŒºé€‰æ‹© ğŸŒ', 'æ‰‹åŠ¨é€‰æ‹© ğŸ‘Œ', 'å…¨å±€ç›´è¿ ğŸ ', 'è‡ªåŠ¨é€‰æ‹© ğŸ“¡'],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Global.png',
			hidden: true,
		},
		// è‡ªåŠ¨é€‰æ‹© ğŸ“¡
		{
			...groupBaseOption,
			name: 'è‡ªåŠ¨é€‰æ‹© ğŸ“¡',
			type: 'url-test',
			proxies: [...allProxy],
			icon: 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Auto.png',
			hidden: true,
		},
		// é¦™æ¸¯èŠ‚ç‚¹ ğŸ‡­ğŸ‡°
		{
			...groupBaseOption,
			'name': 'é¦™æ¸¯èŠ‚ç‚¹ ğŸ‡­ğŸ‡°',
			'type': 'url-test',
			'filter': '(?i)æ¸¯|HK|Hong Kong|HongKong|ğŸ‡­ğŸ‡°',
			'include-all': true,
			'icon': 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hong_Kong.png',
			'hidden': true,
		},
		// å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³
		{
			...groupBaseOption,
			'name': 'å°æ¹¾èŠ‚ç‚¹ ğŸ‡¨ğŸ‡³',
			'type': 'url-test',
			'filter': '(?i)å°|å°æ¹¾|TAIWAN|TW|TAI WAN|ğŸ‡¹ğŸ‡¼',
			'include-all': true,
			'icon': 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Taiwan.png',
			'hidden': true,
		},
		// ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸
		{
			...groupBaseOption,
			'name': 'ç¾å›½èŠ‚ç‚¹ ğŸ‡ºğŸ‡¸',
			'type': 'url-test',
			'filter': '(?i)United States|America|USA|US|ğŸ‡ºğŸ‡¸|ç¾å›½',
			'include-all': true,
			'icon': 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/United_States.png',
			'hidden': true,
		},
		// æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ
		{
			...groupBaseOption,
			'name': 'æ—¥æœ¬èŠ‚ç‚¹ ğŸ‡¯ğŸ‡µ',
			'type': 'url-test',
			'filter': '(?i)JP|ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|Japan',
			'include-all': true,
			'icon': 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Japan.png',
			'hidden': true,
		},
		// æ–°åŠ å¡èŠ‚ç‚¹ ğŸ‡¸ğŸ‡¬
		{
			...groupBaseOption,
			'name': 'æ–°åŠ å¡èŠ‚ç‚¹ ğŸ‡¸ğŸ‡¬',
			'type': 'url-test',
			'filter': '(?i)SG|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|Singapore',
			'include-all': true,
			'icon': 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Singapore.png',
			'hidden': true,
		},
		// éŸ©å›½èŠ‚ç‚¹ ğŸ‡°ğŸ‡·
		{
			...groupBaseOption,
			'name': 'éŸ©å›½èŠ‚ç‚¹ ğŸ‡°ğŸ‡·',
			'type': 'url-test',
			'filter': '(?i)éŸ©å›½|KR|Korea|KOR|ğŸ‡°ğŸ‡·',
			'include-all': true,
			'icon': 'https://fastly.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Korea.png',
			'hidden': true,
		},
	]

	// è¦†ç›–åŸé…ç½®ä¸­çš„è§„åˆ™
	config['rule-providers'] = ruleProviders
	config['rules'] = rules

	// è¿”å›ä¿®æ”¹åçš„é…ç½®
	return config
}
